<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>To-Do App</title>

<style>
    *{box-sizing:border-box;font-family:Arial}
    body{
        margin:0;
        background:rgb(49, 96, 189);
        display:flex;
        justify-content:center;
        padding:20px;
    }
    .container{
        background:white;
        width:100%;
        max-width:600px;
        padding:20px;
        border-radius:12px;
        box-shadow:0 4px 16px rgba(0,0,0,0.1);
    }
    h1{text-align:center;margin-bottom:20px}
    input, textarea{
        width:100%;
        padding:10px;
        margin-bottom:10px;
        border-radius:8px;
        border:1px solid #ccc;
    }
    button{
        padding:10px;
        border:none;
        border-radius:8px;
        cursor:pointer;
        font-weight:bold;
    }
    .add-btn{background:#4f46e5;color:white;width:100%;}
    .task{
        background:#fafafa;
        padding:12px;
        margin-top:12px;
        border-radius:8px;
        border:1px solid #ddd;
    }
    .task-title{font-weight:bold;margin:0 0 4px 0}
    .actions{
        margin-top:8px;
        display:flex;
        gap:10px;
    }
    .edit-btn{background:#06b6d4;color:white;flex:1}
    .delete-btn{background:#ef4444;color:white;flex:1}
    .reminder-tag{
        display:inline-block;
        font-size:12px;
        background:#e5e7eb;
        padding:4px 6px;
        border-radius:6px;
        margin-top:4px;
        color:#374151;
    }
</style>
</head>

<body>
<div class="container">
    <h1>To-Do List</h1>

    <input id="title" placeholder="Task title">
    <textarea id="description" placeholder="Description (optional)"></textarea>
    <input type="datetime-local" id="reminder">
    <button class="add-btn" onclick="addTask()">Add Task</button>

    <div id="taskList"></div>
</div>

<script>
// --- Local Storage Key ---
const STORAGE_KEY = "todo_tasks";

// Load tasks or empty array
let tasks = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

// Save tasks into localStorage
function saveTasks() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
}

// Add Task
function addTask() {
    const title = document.getElementById("title").value.trim();
    const desc = document.getElementById("description").value.trim();
    const reminder = document.getElementById("reminder").value;

    if (!title) {
        alert("Please enter a task title.");
        return;
    }

    const task = {
        id: Date.now(),
        title: title,
        description: desc,
        reminder: reminder ? new Date(reminder).getTime() : null,
        notified: false,
        createdAt: Date.now()
    };

    tasks.push(task);
    saveTasks();
    render();
    clearInputs();
}

// Clear form inputs
function clearInputs() {
    document.getElementById("title").value = "";
    document.getElementById("description").value = "";
    document.getElementById("reminder").value = "";
}

// Edit Task
function editTask(id) {
    const task = tasks.find(t => t.id === id);
    if (!task) return;

    const newTitle = prompt("Edit title:", task.title);
    if (newTitle === null) return;

    const newDesc = prompt("Edit description:", task.description);

    task.title = newTitle.trim() || task.title;
    if (newDesc !== null) task.description = newDesc;

    saveTasks();
    render();
}

// Delete Task
function deleteTask(id) {
    tasks = tasks.filter(t => t.id !== id);
    saveTasks();
    render();
}

// Render all tasks
function render() {
    const list = document.getElementById("taskList");
    list.innerHTML = "";

    tasks.forEach(task => {
        const div = document.createElement("div");
        div.className = "task";

        div.innerHTML = `
            <div class="task-title">${task.title}</div>
            <div>${task.description || ""}</div>
            ${task.reminder ? `<div class="reminder-tag">‚è∞ ${new Date(task.reminder).toLocaleString()}</div>` : ""}
            <div class="actions">
                <button class="edit-btn" onclick="editTask(${task.id})">Edit</button>
                <button class="delete-btn" onclick="deleteTask(${task.id})">Delete</button>
            </div>
        `;

        list.appendChild(div);
    });
}

// Reminder Check
function checkReminders() {
    const now = Date.now();

    tasks.forEach(task => {
        if (task.reminder && !task.notified && now >= task.reminder) {
            task.notified = true;
            alert("üîî Reminder: " + task.title);
            saveTasks();
        }
    });
}

// Run reminder checker every second
setInterval(checkReminders, 1000);

// Initial render
render();
</script>
</body>
</html>
